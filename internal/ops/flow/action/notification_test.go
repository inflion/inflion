package action

import "testing"

func Test_ignore_list(t *testing.T) {
	list:= "192.165.0.0,192.165.0.1,192.165.0.2,192.165.0.3,192.165.0.4,192.165.0.5,192.165.0.6,192.165.0.7,192.165.0.8,192.165.0.9,192.165.0.10,192.165.0.11,192.165.0.12,192.165.0.13,192.165.0.14,192.165.0.15,192.165.0.16,192.165.0.17,192.165.0.18,192.165.0.19,192.165.0.20,192.165.0.21,192.165.0.22,192.165.0.23,192.165.0.24,192.165.0.25,192.165.0.26,192.165.0.27,192.165.0.28,192.165.0.29,192.165.0.30,192.165.0.31,192.165.0.32,192.165.0.33,192.165.0.34,192.165.0.35,192.165.0.36,192.165.0.37,192.165.0.38,192.165.0.39,192.165.0.40,192.165.0.41,192.165.0.42,192.165.0.43,192.165.0.44,192.165.0.45,192.165.0.46,192.165.0.47,192.165.0.48,192.165.0.49,192.165.0.50,192.165.0.51,192.165.0.52,192.165.0.53,192.165.0.54,192.165.0.55,192.165.0.56,192.165.0.57,192.165.0.58,192.165.0.59,192.165.0.60,192.165.0.61,192.165.0.62,192.165.0.63,192.165.0.64,192.165.0.65,192.165.0.66,192.165.0.67,192.165.0.68,192.165.0.69,192.165.0.70,192.165.0.71,192.165.0.72,192.165.0.73,192.165.0.74,192.165.0.75,192.165.0.76,192.165.0.77,192.165.0.78,192.165.0.79,192.165.0.80,192.165.0.81,192.165.0.82,192.165.0.83,192.165.0.84,192.165.0.85,192.165.0.86,192.165.0.87,192.165.0.88,192.165.0.89,192.165.0.90,192.165.0.91,192.165.0.92,192.165.0.93,192.165.0.94,192.165.0.95,192.165.0.96,192.165.0.97,192.165.0.98,192.165.0.99,192.165.0.100,192.165.0.101,192.165.0.102,192.165.0.103,192.165.0.104,192.165.0.105,192.165.0.106,192.165.0.107,192.165.0.108,192.165.0.109,192.165.0.110,192.165.0.111,192.165.0.112,192.165.0.113,192.165.0.114,192.165.0.115,192.165.0.116,192.165.0.117,192.165.0.118,192.165.0.119,192.165.0.120,192.165.0.121,192.165.0.122,192.165.0.123,192.165.0.124,192.165.0.125,192.165.0.126,192.165.0.127,192.165.0.128,192.165.0.129,192.165.0.130,192.165.0.131,192.165.0.132,192.165.0.133,192.165.0.134,192.165.0.135,192.165.0.136,192.165.0.137,192.165.0.138,192.165.0.139,192.165.0.140,192.165.0.141,192.165.0.142,192.165.0.143,192.165.0.144,192.165.0.145,192.165.0.146,192.165.0.147,192.165.0.148,192.165.0.149,192.165.0.150,192.165.0.151,192.165.0.152,192.165.0.153,192.165.0.154,192.165.0.155,192.165.0.156,192.165.0.157,192.165.0.158,192.165.0.159,192.165.0.160,192.165.0.161,192.165.0.162,192.165.0.163,192.165.0.164,192.165.0.165,192.165.0.166,192.165.0.167,192.165.0.168,192.165.0.169,192.165.0.170,192.165.0.171,192.165.0.172,192.165.0.173,192.165.0.174,192.165.0.175,192.165.0.176,192.165.0.177,192.165.0.178,192.165.0.179,192.165.0.180,192.165.0.181,192.165.0.182,192.165.0.183,192.165.0.184,192.165.0.185,192.165.0.186,192.165.0.187,192.165.0.188,192.165.0.189,192.165.0.190,192.165.0.191,192.165.0.192,192.165.0.193,192.165.0.194,192.165.0.195,192.165.0.196,192.165.0.197,192.165.0.198,192.165.0.199,192.165.0.200,192.165.0.201,192.165.0.202,192.165.0.203,192.165.0.204,192.165.0.205,192.165.0.206,192.165.0.207,192.165.0.208,192.165.0.209,192.165.0.210,192.165.0.211,192.165.0.212,192.165.0.213,192.165.0.214,192.165.0.215,192.165.0.216,192.165.0.217,192.165.0.218,192.165.0.219,192.165.0.220,192.165.0.221,192.165.0.222,192.165.0.223,192.165.0.224,192.165.0.225,192.165.0.226,192.165.0.227,192.165.0.228,192.165.0.229,192.165.0.230,192.165.0.231,192.165.0.232,192.165.0.233,192.165.0.234,192.165.0.235,192.165.0.236,192.165.0.237,192.165.0.238,192.165.0.239,192.165.0.240,192.165.0.241,192.165.0.242,192.165.0.243,192.165.0.244,192.165.0.245,192.165.0.246,192.165.0.247,192.165.0.248,192.165.0.249,192.165.0.250,192.165.0.251,192.165.0.252,192.165.0.253,192.165.0.254"
	il := newIgnoreList(list)
	got := il.contains("{\"serviceName\":\"guardduty\",\"detectorId\":\"2eb97550407966a1133f8a43032a0d6f\",\"action\":{\"actionType\":\"AWS_API_CALL\",\"awsApiCallAction\":{\"api\":\"ListDetectors\",\"serviceName\":\"guardduty.amazonaws.com\",\"callerType\":\"Remote IP\",\"remoteIpDetails\":{\"ipAddressV4\":\"192.165.0.39\",\"organization\":{\"asn\":\"2514\",\"asnOrg\":\"NTT PC Communications, Inc.\",\"isp\":\"NTT PC Communications\",\"org\":\"NTT PC Communications\"},\"country\":{\"countryName\":\"Japan\"},\"city\":{\"cityName\":\"Toshima\"},\"geoLocation\":{\"lat\":35.7328,\"lon\":139.7126}},\"affectedResources\":{}}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{},\"evidence\":null,\"eventFirstSeen\":\"2020-06-25T08:33:14Z\",\"eventLastSeen\":\"2020-06-25T08:33:16Z\",\"archived\":false,\"count\":5}")
	if got != true {
		t.Error(got)
	}
}